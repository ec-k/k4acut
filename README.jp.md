# K4A Recording Trimmer

Azure Kinect の録画ファイル（.mkv）を，指定した時間範囲で切り抜くための CLI ツールです．`K4AdotNet`ライブラリを使用し，デバイス設定やストリームデータを維持したまま抽出を行います．

## 使い方

以下の引数を指定して実行する．

```bash
k4acut <入力パス> <出力パス> <開始時間> <終了時間>
```

- `入力パス`: 元の .mkv ファイルのパス
- `出力パス`: 保存先の .mkv ファイルのパス
- `開始時間`: 切り出し開始時間 (フォーマット: `HH:mm:ss`)
- `終了時間`: 切り出し終了時間 (フォーマット: `HH:mm:ss`)

### 実行例

5 秒目から 15 秒目まで（10 秒間）を抽出する場合：

```bash
k4acut input.mkv output.mkv 00:00:05 00:00:15
```

## 特徴

- **設定の維持**: 元ファイルのカラー解像度，深度モード，FPS 設定などを自動的に引き継ぐ．
- **IMU サポート**: オリジナルに IMU データが含まれている場合，自動的に IMU トラックを追加して保存する．
- **スロットリング**: ディスクへの書き込み速度が追いつかずにフレーム落ちが発生するのを防ぐため，ループ内に僅かな待機時間（`Task.Delay(1)`）を設けている．

## 制限事項

- **IMU の同期**: 現状の実装では，キャプチャ（映像フレーム）と IMU サンプルが 1 対 1 で記録されていることを前提としている．Azure Kinect の IMU は映像より高いサンプリングレートで動作するため，このスクリプトでは多くの IMU データが欠落する可能性がある．すべての IMU データを保持するには，IMU 読み込みロジックをキャプチャのループから分離する必要がある．
